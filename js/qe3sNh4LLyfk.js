with(Math){for(i in c)c[i[x=m=n=k=0]+(i[6]||"")]=c[i];for(W=a.width,H=a.height,f=["#e43","#92a","#29e","#4a5","#f90"],d=min(W,H)/7,L=W/2-3*d+d/2,R=H/2-3*d,g=[],h=[],onmousedown=function(){k=1};x<6;x++)for(y=0;y<6;y++)g.push({o:f[5*random()|0],Y:R+y*d,x:L+x*d,y:R+y*d,r:y,c:x});onmouseup=ontouchend=function(){for(i in h[1]||(h=[]),h)p=h[i],p.r>=0&&(m++,p.r-=n+1,p.y=R+p.r*d,p.o=f[5*random()|0]);n=k=0,h=[]},onmousemove=ontouchmove=function(o){if(o.pageX?(X=o.pageX,Y=o.pageY):(X=o.touches[0].pageX,k=Y=o.touches[0].pageY),k)for(i in g)p=g[i],h[0]&&h[0].o!=p.o|1!=abs(abs(h[0].r-p.r)-abs(h[0].c-p.c))||abs(X-p.x)<d/2&&abs(Y-p.y)<d/2&&(~h.indexOf(p)?h[1]==p&&h.shift():(h.unshift(p),n=max(p.r,n)))},setInterval((function(){for(i in c.ce(0,0,W,H),c.lineWidth=d/6,c.lineJoin="round",g){for(j in p=g[i],r=0,g)q=g[j],p.r+1==q.r&&p.c==q.c&&(r=1);r||5==p.r||(p.r++,p.Y=R+p.r*d),p.y!=p.Y?(D=p.y>p.Y?-1:1,p.y+=p.T*D,p.T*=p.s&&!p.t?.5:1.5,(~D&&p.y>=p.Y||!~D&&p.y<=p.Y)&&(p.y=p.Y),p.s||p.t||p.y!=p.Y?p.s&&!p.t&&p.y==p.Y&&(p.t=1,p.T=d/15,p.Y+=d/3):(p.s=1,p.Y-=d/3,p.T=d/5)):(p.T=d/15,p.t=p.s=0),c.strokeStyle=p.o,~h.indexOf(p)&&c.sR(p.x-d/3,p.y-d/3,d/1.5,d/1.5),c.sR(p.x-d/4,p.y-d/4,d/2,d/2)}if(c.font=d/3+"px s",c.fx("Z "+m,L,R+6*d),h[0]){for(i in c.strokeStyle=h[0].o,c.ba(),c.m(X,Y),h)p=h[i],c.l(p.x,p.y);c.s()}}),33)}